# Анализ конфигурации Docker Compose

## Используемые сервисы
- nginx
- postgres  
- pgadmin

## Плохая практика Docker Compose

**Критические проблемы:**
- Использование версий `latest` - нестабильность при обновлениях
- Логины и пароли БД в открытом виде в YML-файле - риск утечек через Git
- `privileged: true` для nginx - root-доступ к хосту, критично для безопасности

## Хорошая практика Docker Compose

**Улучшения:**
- Фиксированные версии образов - стабильность при обновлениях
- Логины и пароли вынесены в конфиг с `.gitignore` - защита важных данных
- Полное отсутствие root-доступа контейнеров к хосту

## Сетевая изоляция

**Реализованная архитектура:**
- Отдельные мостовые сети для nginx и postgres+pgadmin
- Postgres и pgadmin разделяют общую сеть (видят друг друга)
- nginx изолирован от других сервисов
- Параметр `internal: true` у dbnet блокирует обход изоляции через хост
- Порт 5432 не опубликован - БД доступна только внутри сети контейнеров

## Сравнение результатов

### Плохой docker-compose
<img src="./bad/ports.jpg" alt=""/>
- Все порты открыты наружу

<img src="./bad/5432.jpg" alt=""/>
- Порт 5432 доступен с хоста - внешний доступ к БД
  
<img src="./bad/iso,jpg" alt=""/>
- Отсутствие изоляции: nginx видит IP postgres

### Хороший docker-compose

<img src="./good/another.jpg" alt=""/>
- Попытка доступа между разными сетями - изоляция работает

<img src="./good/nonginx.jpg" alt=""/>
- В сети БД только 2 соседа (postgres+pgadmin), nginx отсутствует

<img src="./good/postgres.jpg" alt=""/>
- Порт postgres скрыт

<img src="./good/iso.jpg" alt=""/>```
- Подтверждение работы изоляции
  
<img src="./good/iso.jpg" alt=""/>
- Попытка хитрого подключения к сети БД извне - отказ
